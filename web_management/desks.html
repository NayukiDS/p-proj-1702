<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Desk</title>
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/desks.css">
    <link rel="stylesheet" href="css/add_panel.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/jquery-ui.min.css">
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/jquery.mousewheel.js"></script>
    <script src="js/global.js"></script>
    <script src="js/desks.js"></script>
    <script src="js/actions.js"></script>
    <script src="js/snowfall.js"></script>
    <script src="js/add.js"></script>
</head>
<body>
    <div id="avatar_border">
        <div id="avatar"></div>
    </div>
    <div class="user_panel">
        <div class="panel">
            <div class="panel_loading">
                <div id="panel_loading_progress">
                    <div class="progress_animation"></div>
                </div>
            </div>
            <div class="panel_container">

                <div class="user_info">
                    <span id="user_id">
                        14521216
                    </span>
                    <span id="user_name">Mamoru</span>
                    <br>
                    <span id="user_authentic">
                        <i class="fa fa-id-card" aria-hidden="true"></i>
                        已认证
                    </span>
                </div>
                <div id="pre_page_btn">
                    <i class="fa fa-arrow-circle-o-left" aria-hidden="true"></i>
                    <i class="fa fa-arrow-circle-left" aria-hidden="true"></i>
                </div>
                <div class="panel_pages">
                    <div class="basic_page" id="page_event_detail">

                    </div>
                    <div class="basic_page current_page" id="page_date">
                        <div class="panel_date_picker" oncontextmenu="return false;">
                            <div id="warning_calendar">
                                <span id="warning_calendar_pick_limit">最多选取7个日期</span>
                            </div>
                            <div id="panel_picker_year">
                                NaN
                            </div>
                            <div id="panel_picker_month">
                                NaN
                            </div>
                            <div class="mouth_change">
                                <!--<i class="fa fa-angle-up" id="btn_month_up" aria-hidden="true"></i>-->
                                <!--&nbsp;-->
                                <!--<i class="fa fa-angle-down" id="btn_month_down" aria-hidden="true"></i>-->
                            </div>
                            <div id="panel_picker_day">
                                <div class="picker_week">
                                    <div class="picker_day_t">周</div>
                                    <div class="picker_day_t">一</div>
                                    <div class="picker_day_t">二</div>
                                    <div class="picker_day_t">三</div>
                                    <div class="picker_day_t">四</div>
                                    <div class="picker_day_t">五</div>
                                    <div class="picker_day_t">六</div>
                                    <div class="picker_day_t">日</div>
                                </div>
                                <div class="picker_week">
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                </div>
                                <div class="picker_week">
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                </div>
                                <div class="picker_week">
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                </div>
                                <div class="picker_week">
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                </div>
                                <div class="picker_week">
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                </div>
                                <div class="picker_week">
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="basic_page" id="page_add">
                        <div class="search_bar" >
                            <i class="fa fa-search" aria-hidden="true"></i>
                            <input id="event_search_input" type="text" maxlength="14" placeholder="课程代码 周边活动">
                            <hr />
                        </div>
                        <div id="search_container">
                            <div class="events">
                                <div class="events_id">
                                    1454585
                                </div>
                                <div class="events_name">
                                    课程 DEMO
                                </div>
                                <div class="event_status_bar">
                                    <i class="fa fa-rss" aria-hidden="true"></i>
                                    <span class="users_count">2500</span>
                                    <i class="fa fa-comments" aria-hidden="true"></i>
                                    <span class="comments_count">82</span>
                                </div>
                            </div>
                            <div class="events"></div>
                        </div>
                        <div class="events_nomore">
                            没有更多了
                            <i class="fa fa-coffee" aria-hidden="true"></i>
                        </div>
                        <div id="custom_add_btn">
                            添加自定义日程|备忘
                        </div>
                    </div>
                </div>


                <div class="logout">
                    <i class="fa fa-sign-out" aria-hidden="true"></i>退出登录
                </div>
            </div>
        </div>

    </div>
    <!--<div id="desk" class="left_container_half">-->
    <div id="desk" class="left_container_full">
        <div class="desk_detail">
            <div class="desk_select">
                <!--<i class="fa fa-chevron-down" aria-hidden="true"></i>-->
                <i class="fa fa-angle-down" aria-hidden="true"></i>
                &nbsp;
                <span id="desk_current">
                    My Desk
                </span>
                &nbsp;
                <!--<i class="fa fa-pencil-square-o" id="icon_name_change" aria-hidden="true"></i>-->
            </div>
            <div class="desk_date_picker">
                <span id="week_current_cn">
                    第NaN周
                </span>
                &nbsp;
                <span id="date_current_cn">
                    <!--1月15日 - 1月17日-->
                </span>

            </div>
            <div class="desk_add_new" id="new_event_btn">
                <span><i class="fa fa-search" aria-hidden="true"></i>&nbsp;添加</span>
            </div>
        </div>
        <div id="desk_flame_canvas">
            <div class="desk_flame">
                <div class="hour_list">
                    <div class="hour_box hour_box_top">
                        <span>0:00</span>
                    </div>
                    <div class="hour_box">
                        <span>1:00</span>
                    </div>
                    <div class="hour_box">
                        <span>2:00</span>
                    </div>
                    <div class="hour_box">
                        <span>3:00</span>
                    </div>
                    <div class="hour_box">
                        <span>4:00</span>
                    </div>
                    <div class="hour_box">
                        <span>5:00</span>
                    </div>
                    <div class="hour_box">
                        <span>6:00</span>
                    </div>
                    <div class="hour_box">
                        <span>7:00</span>
                    </div>
                    <div class="hour_box">
                        <span>8:00</span>
                    </div>
                    <div class="hour_box">
                        <span>9:00</span>
                    </div>
                    <div class="hour_box">
                        <span>10:00</span>
                    </div>
                    <div class="hour_box">
                        <span>11:00</span>
                    </div>
                    <div class="hour_box">
                        <span>12:00</span>
                    </div>
                    <div class="hour_box">
                        <span>13:00</span>
                    </div>
                    <div class="hour_box">
                        <span>14:00</span>
                    </div>
                    <div class="hour_box">
                        <span>15:00</span>
                    </div>
                    <div class="hour_box">
                        <span>16:00</span>
                    </div>
                    <div class="hour_box">
                        <span>17:00</span>
                    </div>
                    <div class="hour_box">
                        <span>18:00</span>
                    </div>
                    <div class="hour_box">
                        <span>19:00</span>
                    </div>
                    <div class="hour_box">
                        <span>20:00</span>
                    </div>
                    <div class="hour_box">
                        <span>21:00</span>
                    </div>
                    <div class="hour_box">
                        <span>22:00</span>
                    </div>
                    <div class="hour_box">
                        <span>23:00</span>
                    </div>
                </div>
                <div id="desk_flame">
                    <div class="flame_day gery"></div>
                    <div class="flame_day white"></div>
                    <div class="flame_day gery"></div>
                    <div class="flame_day white"></div>
                    <div class="flame_day gery"></div>
                    <div class="flame_day white"></div>
                    <div class="flame_day gery"></div>
                </div>
                <div id="desk_flame_container">
                    <div class="flame_day_container">
                        <!--<div class="event">-->

                        <!--</div>-->
                    </div>
                    <div class="flame_day_container"></div>
                    <div class="flame_day_container"></div>
                    <div class="flame_day_container"></div>
                    <div class="flame_day_container"></div>
                    <div class="flame_day_container"></div>
                    <div class="flame_day_container"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="add_panel">
        <div class="add_info_container">
            <div class="add_info">
                <div class="snow_container">
                    <div id="snow">
                        <script type='text/javascript'>
                            var collectOnMe = document.querySelectorAll('.collectonme'),
                                buttons = document.getElementsByTagName("input");

                            for(var i = 0; i < collectOnMe.length; i++){
                                collectOnMe[i].style.display = "none";
                            }
                        </script>
                        <div id="kanzaki1">
                            <div class="kanzaki1 kanzaki_box">
                                <script type='text/javascript'>
                                    snowFall.snow(document.querySelector('.kanzaki1'));
                                    snowFall.snow(document.querySelector('.kanzaki1'), "clear");
                                    snowFall.snow(document.querySelector('.kanzaki1'), {image : "./res/kanzaki1.png",
                                        flakeCount : 6, minSize: 80, maxSize:120, minSpeed:5, maxSpeed:10});
                                </script>
                            </div>
                            <div class="kanzaki2 kanzaki_box">
                                <script type='text/javascript'>
                                    snowFall.snow(document.querySelector('.kanzaki2'));
                                    snowFall.snow(document.querySelector('.kanzaki2'), "clear");
                                    snowFall.snow(document.querySelector('.kanzaki2'), {image : "./res/kanzaki2.png",
                                        flakeCount : 6, minSize: 80, maxSize:120, minSpeed:5, maxSpeed:10});
                                </script>
                            </div>
                            <div class="kanzaki3 kanzaki_box">
                                <script type='text/javascript'>
                                    snowFall.snow(document.querySelector('.kanzaki3'));
                                    snowFall.snow(document.querySelector('.kanzaki3'), "clear");
                                    snowFall.snow(document.querySelector('.kanzaki3'), {image : "./res/kanzaki3.png",
                                        flakeCount : 6, minSize: 80, maxSize:120, minSpeed:5, maxSpeed:10});
                                </script>
                            </div>
                            <div class="kanzaki4 kanzaki_box">
                                <script type='text/javascript'>
                                    snowFall.snow(document.querySelector('.kanzaki4'));
                                    snowFall.snow(document.querySelector('.kanzaki4'), "clear");
                                    snowFall.snow(document.querySelector('.kanzaki4'), {image : "./res/kanzaki4.png",
                                        flakeCount : 6, minSize: 80, maxSize:120, minSpeed:5, maxSpeed:10});
                                </script>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="add_input_container">
                    <div class="add_info_id">
                        <input type="text" id="add_info_id_input" class="noflame_input" placeholder="课程代码">
                    </div>
                    <div class="add_info_name">
                        <!--<span class="add_info_name_title">课程名称</span>-->
                        <input type="text" id="add_info_name_input" class="noflame_input input_can" placeholder="课程名称">
                    </div>
                    <div class="add_info_semester">
                        <input type="text" id="add_info_semester_input" class="noflame_input input_can" placeholder="学期">
                    </div>
                    <div class="add_info_professor_id">
                        <input type="text" id="add_info_professor_id_input" class="noflame_input input_can" placeholder="教师编号">
                    </div>
                    <div class="add_info_professor_name">
                        <input type="text" id="add_info_professor_name_input" class="noflame_input input_can" placeholder="教师名称">
                    </div>
                </div>
            </div>
            <div class="add_date_picker_container">
                <div class="add_date_group">
                    <div class="week_detail">
                        <div class="week_wday" wday="1">周一</div>
                        <input type="text" class="week_location noflame_input input_can" placeholder="授课地点">
                    </div>
                    <div class="week_pick_filter">
                        <div class="week_time_pick_start time_pick_btn" time_c="1">第1节</div>
                        <span style="position:absolute; right: 29.8rem; font-size:2rem; top:-0.3rem; opacity: 0.3">-</span>
                        <div class="week_time_pick_end time_pick_btn" time_c="2">第2节</div>
                        <div class="week_filter_xx filter_btn">选修</div>
                        <div class="week_filter_ss filter_btn">标准</div>
                        <div class="week_filter_sw filter_btn">单周</div>
                        <div class="week_filter_dw filter_btn">双周</div>
                        <div class="week_filter_cl filter_btn">清空</div>
                    </div>
                    <div class="week_group">
                        <div class="week_single">1</div>
                        <div class="week_single">2</div>
                        <div class="week_single">3</div>
                        <div class="week_single">4</div>
                        <div class="week_single">5</div>
                        <div class="week_single">6</div>
                        <div class="week_single">7</div>
                        <div class="week_single">8</div>
                        <div class="week_single">9</div>
                        <div class="week_single">10</div>
                        <div class="week_single">11</div>
                        <div class="week_single">12</div>
                        <div class="week_single">13</div>
                        <div class="week_single">14</div>
                        <div class="week_single">15</div>
                        <div class="week_single">16</div>
                        <div class="week_single">17</div>
                        <div class="week_single">18</div>
                        <div class="week_single">19</div>
                        <div class="week_single">20</div>
                        <div class="week_single">21</div>
                        <div class="week_single">22</div>
                    </div>
                    <div class="date_group_new date_group_btn">+</div>
                    <div class="date_group_remove date_group_btn">-</div>
                </div>
            </div>
        </div>
        <div id="candidate_panel">
            <div class="candidate_single">
                <div class="candidate_title">贝奥兰迪</div>
                <div class="candidate_title_child">猎天使 魔男</div>
                <div class="candidate_title_info">我也是个广东人 所以我们是老乡</div>
            </div>
            <div class="candidate_single">
                <div class="candidate_title">van darkholme</div>
                <div class="candidate_title_child">VAN</div>
                <div class="candidate_title_info">boy next door</div>
            </div>
            <div class="candidate_single">
                <div class="candidate_title">木吉</div>
                <div class="candidate_title_child">KAZUYA</div>
                <div class="candidate_title_info">hohoho check it out</div>
            </div>
        </div>
        <script>
            var can_panel = $('#candidate_panel');
            var can_evoke = undefined;
            var can_evoke_mate = undefined;
            var add_container = $('.add_info_container');
            $(document).on('mouseover', '.time_pick_btn', function (event){
                add_container.css('overflow-y','hidden');
            });
            $(document).on('mouseout', '.time_pick_btn', function (event){
                add_container.css('overflow-y','scroll');
            });
            $(document).on('mouseover', '.week_wday', function (event){
                add_container.css('overflow-y','hidden');
            });
            $(document).on('mouseout', '.week_wday', function (event){
                add_container.css('overflow-y','scroll');
            });
            $(document).on('click input propertychange', '#add_info_name_input', function (event){
                can_evoke = $(event.target);
                var search_str = $(event.target).val();
                event_change(search_str);
                // can_panel.html("<div class=\"candidate_single\">\n" +
                //     "                <div class=\"candidate_title\">嵌入式系统</div>\n" +
                //     "                <div class=\"candidate_title_child\">韩德强</div>\n" +
                //     "                <div class=\"candidate_title_info\">#160018 2017-18第一学期</div>\n" +
                //     "                <div class=\"candidate_cover\"></div>\n" +
                //     "            </div>\n" +
                //     "            <div class=\"candidate_single\">\n" +
                //     "                <div class=\"candidate_title\">计算机网络安全</div>\n" +
                //     "                <div class=\"candidate_title_child\">郑鲲</div>\n" +
                //     "                <div class=\"candidate_title_info\">#160020 2017-18第一学期</div>\n" +
                //     "                <div class=\"candidate_cover\"></div>\n" +
                //     "            </div>\n" +
                //     "            <div class=\"candidate_single\">\n" +
                //     "                <div class=\"candidate_title\">操作系统</div>\n" +
                //     "                <div class=\"candidate_title_child\">张俪珩</div>\n" +
                //     "                <div class=\"candidate_title_info\">#150512 2016-17第二学期</div>\n" +
                //     "                <div class=\"candidate_cover\"></div>\n" +
                //     "            </div>")
            });
            $(document).on('click input propertychange', '#add_info_semester_input', function (event){
                can_evoke = $(event.target);
                var search_str = $(event.target).val();
                semester_change(search_str);
            });
            $(document).on('click input propertychange', '#add_info_professor_id_input', function (event){
                can_evoke = $(event.target);
                var search_str = $(event.target).val();
                t_id_change(search_str);
            });
            $(document).on('click input propertychange', '#add_info_professor_name_input', function (event){
                can_evoke = $(event.target);
                var search_str = $(event.target).val();
                t_name_change(search_str);
            });
            $(document).on('click input propertychange', '.week_location', function (event){
                can_evoke = $(event.target);
                var search_str = $(event.target).val();
                location_change(search_str);
            });
            $(document).on('click', '.candidate_cover', function (event){
                var title = $(event.target);
                title= title.parent();
                if(can_evoke.attr("id")==='add_info_name_input'){
                    console.log("12313");
                    $('#add_info_name_input').val($(title).attr('event_name'));
                    $('#add_info_semester_input').val('2017');
                    $('#add_info_professor_id_input').val($(title).attr('holder_id'));
                    $('#add_info_professor_name_input').val($(title).attr('holder_name'));
                    var schedule_obj = $(title).attr('schedule');
                    schedule_obj = decodeURIComponent(schedule_obj);
                    schedule_obj = JSON.parse(schedule_obj);
                    if(!schedule_obj)return;
                    var week_list = $('.add_date_picker_container');
                    week_list.html("");
                    schedule_obj.forEach(function (value, index) {
                        var str_all = "<div class=\"add_date_group\">\n" +
                            "                    <div class=\"week_detail\">\n";
                        var str_temp = "";
                        switch (value.day){
                            case 'mo':
                                str_temp = "                        <div class=\"week_wday\" wday=\"1\">周一</div>\n";
                                break;
                            case 'tu':
                                str_temp = "                        <div class=\"week_wday\" wday=\"2\">周二</div>\n";
                                break;
                            case 'we':
                                str_temp = "                        <div class=\"week_wday\" wday=\"3\">周三</div>\n";
                                break;
                            case 'th':
                                str_temp = "                        <div class=\"week_wday\" wday=\"4\">周四</div>\n";
                                break;
                            case 'fr':
                                str_temp = "                        <div class=\"week_wday\" wday=\"5\">周五</div>\n";
                                break;
                            case 'sa':
                                str_temp = "                        <div class=\"week_wday\" wday=\"6\">周六</div>\n";
                                break;
                            case 'su':
                                str_temp = "                        <div class=\"week_wday\" wday=\"7\">周日</div>\n";
                                break;
                        }
                        str_all = str_all + str_temp;
                        str_temp = "                        <input type=\"text\" class=\"week_location noflame_input input_can\" placeholder=\"授课地点\">\n" +
                            "                    </div>\n" +
                            "                    <div class=\"week_pick_filter\">\n";
                        str_all = str_all + str_temp;
                        var course_start = 1;
                        var course_end = 1;
                        switch (value.time[0]){
                            case 800:
                                course_start = 1;
                                break;
                            case 855:
                                course_start = 2;
                                break;
                            case 1000:
                                course_start = 3;
                                break;
                            case 1055:
                                course_start = 4;
                                break;
                            case 1330:
                                course_start = 5;
                                break;
                            case 1425:
                                course_start = 6;
                                break;
                            case 1530:
                                course_start = 7;
                                break;
                            case 1625:
                                course_start = 8;
                                break;
                            case 1750:
                                course_start = 9;
                                break;
                            case 1845:
                                course_start = 10;
                                break;
                            case 1950:
                                course_start = 11;
                                break;
                        }
                        switch (value.time[1]){
                            case 845:
                                course_end = 1;
                                break;
                            case 940:
                                course_end = 2;
                                break;
                            case 1045:
                                course_end = 3;
                                break;
                            case 1140:
                                course_end = 4;
                                break;
                            case 1415:
                                course_end = 5;
                                break;
                            case 1510:
                                course_end = 6;
                                break;
                            case 1615:
                                course_end = 7;
                                break;
                            case 1710:
                                course_end = 8;
                                break;
                            case 1835:
                                course_end = 9;
                                break;
                            case 1910:
                                course_end = 10;
                                break;
                            case 2035:
                                course_end = 11;
                                break;
                        }
                        str_temp =
                            "                        <div class=\"week_time_pick_start time_pick_btn\" time_c=\""+course_start+"\">第"+course_start+"节</div>\n" +
                            "                        <span style=\"position:absolute; right: 29.8rem; font-size:2rem; top:-0.3rem; opacity: 0.3\">-</span>\n" +
                            "                        <div class=\"week_time_pick_end time_pick_btn\" time_c=\""+course_end+"\">第"+course_end+"节</div>\n" +
                            "                        <div class=\"week_filter_xx filter_btn\">选修</div>\n" +
                            "                        <div class=\"week_filter_ss filter_btn\">标准</div>\n" +
                            "                        <div class=\"week_filter_sw filter_btn\">单周</div>\n" +
                            "                        <div class=\"week_filter_dw filter_btn\">双周</div>\n" +
                            "                        <div class=\"week_filter_cl filter_btn\">清空</div>\n" +
                            "                    </div>\n" +
                            "                    <div class=\"week_group\">\n" +
                            "                        <div class=\"week_single\">1</div>\n" +
                            "                        <div class=\"week_single\">2</div>\n" +
                            "                        <div class=\"week_single\">3</div>\n" +
                            "                        <div class=\"week_single\">4</div>\n" +
                            "                        <div class=\"week_single\">5</div>\n" +
                            "                        <div class=\"week_single\">6</div>\n" +
                            "                        <div class=\"week_single\">7</div>\n" +
                            "                        <div class=\"week_single\">8</div>\n" +
                            "                        <div class=\"week_single\">9</div>\n" +
                            "                        <div class=\"week_single\">10</div>\n" +
                            "                        <div class=\"week_single\">11</div>\n" +
                            "                        <div class=\"week_single\">12</div>\n" +
                            "                        <div class=\"week_single\">13</div>\n" +
                            "                        <div class=\"week_single\">14</div>\n" +
                            "                        <div class=\"week_single\">15</div>\n" +
                            "                        <div class=\"week_single\">16</div>\n" +
                            "                        <div class=\"week_single\">17</div>\n" +
                            "                        <div class=\"week_single\">18</div>\n" +
                            "                        <div class=\"week_single\">19</div>\n" +
                            "                        <div class=\"week_single\">20</div>\n" +
                            "                        <div class=\"week_single\">21</div>\n" +
                            "                        <div class=\"week_single\">22</div>\n" +
                            "                    </div>\n" +
                            "                    <div class=\"date_group_new date_group_btn\">+</div>\n" +
                            "                    <div class=\"date_group_remove date_group_btn\">-</div>\n" +
                            "                </div>";
                        str_all = str_all + str_temp;
                        week_list.append(str_all);
                        var c_week_list = $(week_list.children());
                        var location = $(c_week_list[index]).find('.week_location');
                        $(location).val(value.location);
                        var wday_list = $(c_week_list[index]).find('.week_group');
                        wday_list = wday_list.children();
                        // console.log(wday_list);
                        for(var i=0;i<22;i++){
                            if(value.week.indexOf(i+1)!==-1){
                                var wday_obj = $(wday_list);
                                $(wday_obj[i]).addClass('week_single_checked');
                            }
                        }
                        // wday_list.each(function (v, i) {
                        //     if(value.week.indexOf(i+1)){
                        //         console.log($(v).html());
                        //         $(v).addClass('week_single_checked');
                        //     }
                        // });
                    });
                    return;
                }
                var title_mate = title.find(".candidate_title_child");
                title = title.find(".candidate_title");
                title = $(title).html();
                title_mate = $(title_mate).html();
                // console.log(title);
                can_evoke.val(title);
                if(can_evoke.hasClass('week_location')){
                    can_evoke.val(title+" "+title_mate);
                }
                if(can_evoke.attr("id")==='add_info_professor_id_input'){
                    // can_evoke_mate = can_evoke.parent();
                    // can_evoke_mate = $(can_evoke_mate).find('#add_info_professor_name_input');
                    can_evoke_mate = $('#add_info_professor_name_input');
                    can_evoke_mate.val(title_mate);
                }
                if(can_evoke.attr("id")==='add_info_professor_name_input'){
                    // can_evoke_mate = can_evoke.parent();
                    // can_evoke_mate = $(can_evoke_mate).find('#add_info_professor_id_input');
                    can_evoke_mate = $('#add_info_professor_id_input');
                    can_evoke_mate.val(title_mate);
                }
            });
            $(document).on('click', '.week_single', function (event) {
                var click_obj = $(event.target);
                if(click_obj.hasClass('week_single_checked')){
                    click_obj.removeClass('week_single_checked');
                }else{
                    click_obj.addClass('week_single_checked');
                }
            });
            $(document).on('click', '.week_filter_sw', function (event) {
               var click_obj = $(event.target);
               var p_obj = click_obj.parent();
               p_obj = p_obj.parent();
               var week_obj = p_obj.find('.week_group');
               week_obj = week_obj.children();
                week_obj.each(function (index, obj) {
                    $(obj).removeClass('week_single_checked');
                   if((index+1)%2!==0&&index<18){
                       $(obj).addClass('week_single_checked');
                   }
               })
            });
            $(document).on('click', '.week_filter_dw', function (event) {
                var click_obj = $(event.target);
                var p_obj = click_obj.parent();
                p_obj = p_obj.parent();
                var week_obj = p_obj.find('.week_group');
                week_obj = week_obj.children();
                week_obj.each(function (index, obj) {
                    $(obj).removeClass('week_single_checked');
                    if((index+1)%2===0&&index<18){
                        $(obj).addClass('week_single_checked');
                    }
                })
            });
            $(document).on('click', '.week_filter_ss', function (event) {
                var click_obj = $(event.target);
                var p_obj = click_obj.parent();
                p_obj = p_obj.parent();
                var week_obj = p_obj.find('.week_group');
                week_obj = week_obj.children();
                week_obj.each(function (index, obj) {
                    $(obj).removeClass('week_single_checked');
                    if(index<18){
                        $(obj).addClass('week_single_checked');
                    }
                })
            });
            $(document).on('click', '.week_filter_cl', function (event) {
                var click_obj = $(event.target);
                var p_obj = click_obj.parent();
                p_obj = p_obj.parent();
                var week_obj = p_obj.find('.week_group');
                week_obj = week_obj.children();
                week_obj.each(function (index, obj) {
                    $(obj).removeClass('week_single_checked');
                })
            });
            $(document).on('click', '.week_filter_xx', function (event) {
                var click_obj = $(event.target);
                var p_obj = click_obj.parent();
                p_obj = p_obj.parent();
                var week_obj = p_obj.find('.week_group');
                week_obj = week_obj.children();
                week_obj.each(function (index, obj) {
                    $(obj).removeClass('week_single_checked');
                    if(index>2&&index<13){
                        $(obj).addClass('week_single_checked');
                    }
                })
            });
            $(document).on('mousewheel', '.week_time_pick_start', function (event) {
                var start_obj = $(event.target);
                var end_obj = start_obj.parent();
                end_obj = end_obj.find('.week_time_pick_end');
                var start_c = parseInt(start_obj.attr("time_c"));
                var end_c = parseInt(end_obj.attr("time_c"));
                if(event.deltaY===1){
                    if(start_c<10){
                        start_c += 1;
                        start_obj.attr("time_c", start_c);
                        $(start_obj).html("第"+start_obj.attr("time_c")+"节");
                        end_c = start_c + 1;
                        end_obj.attr("time_c", end_c);
                        $(end_obj).html("第"+end_obj.attr("time_c")+"节");
                    }else if(start_c===10){
                        start_c += 1;
                        start_obj.attr("time_c", start_c);
                        $(start_obj).html("第"+start_obj.attr("time_c")+"节");
                    }
                }
                if(event.deltaY===-1){
                    if(start_c>1){
                        start_c -= 1;
                        start_obj.attr("time_c", start_c);
                        $(start_obj).html("第"+start_obj.attr("time_c")+"节");
                    }
                }
            });
            $(document).on('mousewheel', '.week_time_pick_end', function (event) {
                var end_obj = $(event.target);
                var start_obj = end_obj.parent();
                start_obj = start_obj.find('.week_time_pick_start');
                var start_c = parseInt(start_obj.attr("time_c"));
                var end_c = parseInt(end_obj.attr("time_c"));
                if(event.deltaY===1){
                    if(end_c<11){
                        end_c += + 1;
                        end_obj.attr("time_c", end_c);
                        $(end_obj).html("第"+end_obj.attr("time_c")+"节");
                    }
                }
                if(event.deltaY===-1){
                    if(end_c>2){
                        end_c -= 1;
                        end_obj.attr("time_c", end_c);
                        $(end_obj).html("第"+end_obj.attr("time_c")+"节");

                        start_c = end_c - 1;
                        start_obj.attr("time_c", start_c);
                        $(start_obj).html("第"+start_obj.attr("time_c")+"节");
                    }else if(end_c===2){
                        end_c -= 1;
                        end_obj.attr("time_c", end_c);
                        $(end_obj).html("第"+end_obj.attr("time_c")+"节");
                    }
                }
            });
            $(document).on('mousewheel', '.week_wday', function (event) {
                var obj = $(event.target);
                var wday = parseInt(obj.attr("wday"));
                if(event.deltaY===1){
                    if(wday<7)wday+=1;
                }
                if(event.deltaY===-1){
                    if(wday>1)wday-=1;
                }
                var wday_str = "";
                switch (wday){
                    case 1:
                        wday_str = "周一";
                        break;
                    case 2:
                        wday_str = "周二";
                        break;
                    case 3:
                        wday_str = "周三";
                        break;
                    case 4:
                        wday_str = "周四";
                        break;
                    case 5:
                        wday_str = "周五";
                        break;
                    case 6:
                        wday_str = "周六";
                        break;
                    case 7:
                        wday_str = "周日";
                        break;
                }
                obj.attr("wday", wday);
                obj.html(wday_str);
            });
            $(document).on('blur', '.input_can', function (event) {
                can_panel.animate({
                    right: "-20rem"
                },200);
            });
            $(document).on('focus', '.input_can', function (event) {
                can_panel.animate({
                    right: "2%"
                },200);
            });
            $(document).on('click', '.date_group_new', function (event) {
                var click_obj = $(event.target);
                var p_obj = click_obj.parent();
                p_obj = p_obj.parent();
                $(p_obj).append("<div class=\"add_date_group\">\n" +
                    "                    <div class=\"week_detail\">\n" +
                    "                        <div class=\"week_wday\" wday=\"1\">周一</div>\n" +
                    "                        <input type=\"text\" class=\"week_location noflame_input input_can\" placeholder=\"授课地点\">\n" +
                    "                    </div>\n" +
                    "                    <div class=\"week_pick_filter\">\n" +
                    "                        <div class=\"week_time_pick_start time_pick_btn\" time_c=\"1\">第1节</div>\n" +
                    "                        <span style=\"position:absolute; right: 29.8rem; font-size:2rem; top:-0.3rem; opacity: 0.3\">-</span>\n" +
                    "                        <div class=\"week_time_pick_end time_pick_btn\" time_c=\"2\">第2节</div>\n" +
                    "                        <div class=\"week_filter_xx filter_btn\">选修</div>\n" +
                    "                        <div class=\"week_filter_ss filter_btn\">标准</div>\n" +
                    "                        <div class=\"week_filter_sw filter_btn\">单周</div>\n" +
                    "                        <div class=\"week_filter_dw filter_btn\">双周</div>\n" +
                    "                        <div class=\"week_filter_cl filter_btn\">清空</div>\n" +
                    "                    </div>\n" +
                    "                    <div class=\"week_group\">\n" +
                    "                        <div class=\"week_single\">1</div>\n" +
                    "                        <div class=\"week_single\">2</div>\n" +
                    "                        <div class=\"week_single\">3</div>\n" +
                    "                        <div class=\"week_single\">4</div>\n" +
                    "                        <div class=\"week_single\">5</div>\n" +
                    "                        <div class=\"week_single\">6</div>\n" +
                    "                        <div class=\"week_single\">7</div>\n" +
                    "                        <div class=\"week_single\">8</div>\n" +
                    "                        <div class=\"week_single\">9</div>\n" +
                    "                        <div class=\"week_single\">10</div>\n" +
                    "                        <div class=\"week_single\">11</div>\n" +
                    "                        <div class=\"week_single\">12</div>\n" +
                    "                        <div class=\"week_single\">13</div>\n" +
                    "                        <div class=\"week_single\">14</div>\n" +
                    "                        <div class=\"week_single\">15</div>\n" +
                    "                        <div class=\"week_single\">16</div>\n" +
                    "                        <div class=\"week_single\">17</div>\n" +
                    "                        <div class=\"week_single\">18</div>\n" +
                    "                        <div class=\"week_single\">19</div>\n" +
                    "                        <div class=\"week_single\">20</div>\n" +
                    "                        <div class=\"week_single\">21</div>\n" +
                    "                        <div class=\"week_single\">22</div>\n" +
                    "                    </div>\n" +
                    "                    <div class=\"date_group_new date_group_btn\">+</div>\n" +
                    "                    <div class=\"date_group_remove date_group_btn\">-</div>\n" +
                    "                </div>");
            });
            $(document).on('click', '.date_group_remove', function (event) {
                var click_obj = $(event.target);
                var p_obj = click_obj.parent();
                $(p_obj).remove();
            });
        </script>
    </div>
</body>

<script>
    $('#avatar_border').on('touchstart click', function () {
        panel_toggle();
    });
    var search_input = $("#event_search_input");
    var custom_add_btn = $("#custom_add_btn");
    var search_container = $("#search_container");
    var search_container_none = $(".events_nomore");
    search_input.focus(function () {
        var hr_obj = $(".search_bar").children('hr');
        hr_obj.animate({
            width: "100%",
            opacity: "0.2"
        },200);
        if(custom_add_btn.css("opacity")!=="0"){
            custom_add_btn.animate({
                opacity: "0",
                top: "+=5rem"
            },200);
        }
        search_container.animate({
            opacity: "1"
        },200);
        search_container.css("display","block");
        search_container_none.animate({
            opacity: "1"
        },200);
        search_container_none.css("display","block");
    });
    search_input.blur(function () {
        var hr_obj = $(".search_bar").children('hr');
        hr_obj.animate({
            width: "0",
            opacity: "0"
        },200);
        if(search_input.val()===""){
            custom_add_btn.animate({
                opacity: "1",
                top: "-=5rem"
            },200);
            search_container.animate({
                opacity: "0"
            },200);
            setTimeout(function () {
                search_container.css("display","none");
            },200);
            search_container_none.animate({
                opacity: "0"
            },200);
            setTimeout(function () {
                search_container_none.css("display","none");
            },200);
        }
    });
    search_input.on('input propertychange',function(){
        var search_input = $("#event_search_input");
        if(search_input.html().length>10){
            search_input.html(search_event_input_available)
        }else if(search_input.html()==='<br>'){
            search_input.html("课程代码 事件名称");
        } else{
            search_event_input_available = search_input.html();
        }
    });
    $('#panel_picker_year').on('mousewheel', function (event) {
        var year = parseInt($('#panel_picker_year').html());
        var month = parseInt($('#panel_picker_month').html());
        if(event.deltaY===1){
            calendar_init(undefined, year-1, month);
        }
        if(event.deltaY===-1){
            calendar_init(undefined, year+1, month);
        }
    });
    $('#panel_picker_month').on('mousewheel', function (event) {
        var year = parseInt($('#panel_picker_year').html());
        var month = parseInt($('#panel_picker_month').html());
        if(event.deltaY===1){
            calendar_init(undefined, year, month-1);
        }
        if(event.deltaY===-1){
            calendar_init(undefined, year, month+1);
        }
    });
    $('#panel_picker_day').on('mousewheel', function (event) {
        var year = parseInt($('#panel_picker_year').html());
        var month = parseInt($('#panel_picker_month').html());
        if(event.deltaY===1){
            calendar_init(undefined, year, month-1);
        }
        if(event.deltaY===-1){
            calendar_init(undefined, year, month+1);
        }
    });
    $('.panel_pages').on('mousewheel', function (event) {
        var html_p = $('#pre_page').html();
        var html_c = $('#current_page').html();
        var html_n = $('#next_page').html();
        if(event.deltaY===1){
            $('#pre_page').html(html_n);
            $('#current_page').html(html_p);
            $('#next_page').html(html_c);
        }
        if(event.deltaY===-1){
            $('#pre_page').html(html_c);
            $('#current_page').html(html_n);
            $('#next_page').html(html_p);
        }
    });
    var pick_day = $('.picker_day');
    pick_day.on('contextmenu', function(event){
        // if(event.ctrlKey){
        //     alert("!");
        //     return;
        // }
        var pick_obj = event.target;
        var s_year = $(pick_obj).attr("s_year");
        var s_month = $(pick_obj).attr("s_month");
        var s_date = $(pick_obj).attr("s_date");
        var date_str = s_year+"-"+s_month+"-"+s_date;
        if(s_year&&s_month&&s_date){
            calendar_init(Date.parse(date_str));
        }else{
            console.log("date load err");
        }
    });
    $('.picker_day').on('click', function(event){
        var pick_obj = event.target;
        var s_year = $(pick_obj).attr("s_year");
        var s_month = $(pick_obj).attr("s_month");
        var s_date = $(pick_obj).attr("s_date");
        var calendar_type = $(pick_obj).attr("calendar_type");
        if(calendar_type==="row_head"){
            date_multi = [];
            var row = $($(event.target).parent().children());
            for(var i=0;i<row.length-1;i++){
                var day_html = $(row[i+1]);
                s_year = day_html.attr("s_year");
                s_month = day_html.attr("s_month");
                s_date = day_html.attr("s_date");
                date_multi_choice(s_year, s_month, s_date, true);
            }
        }else{
            var warning_obj = $('#warning_calendar_pick_limit');
            if(date_multi_choice(s_year, s_month, s_date)){
                animation_blink_hide(warning_obj, true);
            }else{
                // warning_obj.animate({
                //
                // },200)
            }
        }
    });
    $('.desk_flame').on('mousewheel', function (event) {
        var desk_flame = $('.desk_flame');
        var s_h = desk_flame.attr("start_hour");
        var e_h = desk_flame.attr("end_hour");
        console.log(s_h+"+"+e_h);
        setDeskflame(s_h-event.deltaY,e_h-event.deltaY);
        // if(event.deltaY===1){
        //     setDeskflame(s_h-1,e_h-1);
        // }
        // if(event.deltaY===-1){
        //     setDeskflame(s_h+1,e_h+1);
        // }
    });
    $('#new_event_btn').on('click', function (event) {
        if($('#desk').hasClass('left_container_full')){
            $('#desk').removeClass('left_container_full');
            $('#desk').addClass('left_container_half');
        }
        page_example('page_date',0);
        page_example('page_add',2);
    });
    $('#pre_page_btn').on('click', function (event) {
        page_example('page_date',2);
        page_example('page_add',1);
    });
</script>
</html>