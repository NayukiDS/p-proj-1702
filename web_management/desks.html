<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Desk</title>
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/desks.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/jquery-ui.min.css">
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/jquery.mousewheel.js"></script>
    <script src="js/global.js"></script>
    <script src="js/desks.js"></script>
    <script src="js/actions.js"></script>
</head>
<body>
    <div id="avatar_border">
        <div id="avatar"></div>
    </div>
    <div class="user_panel">
        <div class="panel">
            <div class="panel_loading">
                <div id="panel_loading_progress">
                    <div class="progress_animation"></div>
                </div>
            </div>
            <div class="panel_container">

                <div class="user_info">
                    <span id="user_id">
                        14521216
                    </span>
                    <span id="user_name">Mamoru</span>
                    <br>
                    <span id="user_authentic">
                        <i class="fa fa-id-card" aria-hidden="true"></i>
                        已认证
                    </span>
                </div>
                <div id="pre_page_btn">
                    <i class="fa fa-arrow-circle-o-left" aria-hidden="true"></i>
                    <i class="fa fa-arrow-circle-left" aria-hidden="true"></i>
                </div>
                <div class="panel_pages">
                    <div class="basic_page" id="page_event_detail">

                    </div>
                    <div class="basic_page current_page" id="page_date">
                        <div class="panel_date_picker" oncontextmenu="return false;">
                            <div id="warning_calendar">
                                <span id="warning_calendar_pick_limit">最多选取7个日期</span>
                            </div>
                            <div id="panel_picker_year">
                                NaN
                            </div>
                            <div id="panel_picker_month">
                                NaN
                            </div>
                            <div class="mouth_change">
                                <!--<i class="fa fa-angle-up" id="btn_month_up" aria-hidden="true"></i>-->
                                <!--&nbsp;-->
                                <!--<i class="fa fa-angle-down" id="btn_month_down" aria-hidden="true"></i>-->
                            </div>
                            <div id="panel_picker_day">
                                <div class="picker_week">
                                    <div class="picker_day_t">周</div>
                                    <div class="picker_day_t">一</div>
                                    <div class="picker_day_t">二</div>
                                    <div class="picker_day_t">三</div>
                                    <div class="picker_day_t">四</div>
                                    <div class="picker_day_t">五</div>
                                    <div class="picker_day_t">六</div>
                                    <div class="picker_day_t">日</div>
                                </div>
                                <div class="picker_week">
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                </div>
                                <div class="picker_week">
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                </div>
                                <div class="picker_week">
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                </div>
                                <div class="picker_week">
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                </div>
                                <div class="picker_week">
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                </div>
                                <div class="picker_week">
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                    <div class="picker_day"></div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="basic_page" id="page_add">
                        <div class="search_bar" >
                            <i class="fa fa-search" aria-hidden="true"></i>
                            <input id="event_search_input" type="text" maxlength="14" placeholder="课程代码 周边活动">
                            <hr />
                        </div>
                        <div id="search_container">
                            <div class="events">
                                <div class="events_id">
                                    1454585
                                </div>
                                <div class="events_name">
                                    课程 DEMO
                                </div>
                                <div class="event_status_bar">
                                    <i class="fa fa-rss" aria-hidden="true"></i>
                                    <span class="users_count">2500</span>
                                    <i class="fa fa-comments" aria-hidden="true"></i>
                                    <span class="comments_count">82</span>
                                </div>
                            </div>
                            <div class="events"></div>
                        </div>
                        <div class="events_nomore">
                            没有更多了
                            <i class="fa fa-coffee" aria-hidden="true"></i>
                        </div>
                        <div id="custom_add_btn">
                            添加自定义日程|备忘
                        </div>
                    </div>
                </div>


                <div class="logout">
                    <i class="fa fa-sign-out" aria-hidden="true"></i>退出登录
                </div>
            </div>
        </div>

    </div>
    <!--<div id="desk" class="left_container_half">-->
    <div id="desk" class="left_container_full">
        <div class="desk_detail">
            <div class="desk_select">
                <!--<i class="fa fa-chevron-down" aria-hidden="true"></i>-->
                <i class="fa fa-angle-down" aria-hidden="true"></i>
                &nbsp;
                <span id="desk_current">
                    My Desk
                </span>
                &nbsp;
                <!--<i class="fa fa-pencil-square-o" id="icon_name_change" aria-hidden="true"></i>-->
            </div>
            <div class="desk_date_picker">
                <span id="week_current_cn">
                    第NaN周
                </span>
                &nbsp;
                <span id="date_current_cn">
                    <!--1月15日 - 1月17日-->
                </span>

            </div>
            <div class="desk_add_new" id="new_event_btn">
                <span><i class="fa fa-search" aria-hidden="true"></i>&nbsp;添加</span>
            </div>
        </div>
        <div id="desk_flame_canvas">
            <div class="desk_flame">
                <div class="hour_list">
                    <div class="hour_box hour_box_top">
                        <span>0:00</span>
                    </div>
                    <div class="hour_box">
                        <span>1:00</span>
                    </div>
                    <div class="hour_box">
                        <span>2:00</span>
                    </div>
                    <div class="hour_box">
                        <span>3:00</span>
                    </div>
                    <div class="hour_box">
                        <span>4:00</span>
                    </div>
                    <div class="hour_box">
                        <span>5:00</span>
                    </div>
                    <div class="hour_box">
                        <span>6:00</span>
                    </div>
                    <div class="hour_box">
                        <span>7:00</span>
                    </div>
                    <div class="hour_box">
                        <span>8:00</span>
                    </div>
                    <div class="hour_box">
                        <span>9:00</span>
                    </div>
                    <div class="hour_box">
                        <span>10:00</span>
                    </div>
                    <div class="hour_box">
                        <span>11:00</span>
                    </div>
                    <div class="hour_box">
                        <span>12:00</span>
                    </div>
                    <div class="hour_box">
                        <span>13:00</span>
                    </div>
                    <div class="hour_box">
                        <span>14:00</span>
                    </div>
                    <div class="hour_box">
                        <span>15:00</span>
                    </div>
                    <div class="hour_box">
                        <span>16:00</span>
                    </div>
                    <div class="hour_box">
                        <span>17:00</span>
                    </div>
                    <div class="hour_box">
                        <span>18:00</span>
                    </div>
                    <div class="hour_box">
                        <span>19:00</span>
                    </div>
                    <div class="hour_box">
                        <span>20:00</span>
                    </div>
                    <div class="hour_box">
                        <span>21:00</span>
                    </div>
                    <div class="hour_box">
                        <span>22:00</span>
                    </div>
                    <div class="hour_box">
                        <span>23:00</span>
                    </div>
                </div>
                <div id="desk_flame">
                    <div class="flame_day gery"></div>
                    <div class="flame_day white"></div>
                    <div class="flame_day gery"></div>
                    <div class="flame_day white"></div>
                    <div class="flame_day gery"></div>
                    <div class="flame_day white"></div>
                    <div class="flame_day gery"></div>
                </div>
                <div id="desk_flame_container">
                    <div class="flame_day_container">
                        <!--<div class="event">-->

                        <!--</div>-->
                    </div>
                    <div class="flame_day_container"></div>
                    <div class="flame_day_container"></div>
                    <div class="flame_day_container"></div>
                    <div class="flame_day_container"></div>
                    <div class="flame_day_container"></div>
                    <div class="flame_day_container"></div>
                </div>
            </div>
        </div>
    </div>
</body>

<script>
    $('#avatar_border').on('touchstart click', function () {
        panel_toggle();
    });
    var search_input = $("#event_search_input");
    var custom_add_btn = $("#custom_add_btn");
    var search_container = $("#search_container");
    var search_container_none = $(".events_nomore");
    search_input.focus(function () {
        var hr_obj = $(".search_bar").children('hr');
        hr_obj.animate({
            width: "100%",
            opacity: "0.2"
        },200);
        if(custom_add_btn.css("opacity")!=="0"){
            custom_add_btn.animate({
                opacity: "0",
                top: "+=5rem"
            },200);
        }
        search_container.animate({
            opacity: "1"
        },200);
        search_container.css("display","block");
        search_container_none.animate({
            opacity: "1"
        },200);
        search_container_none.css("display","block");
    });
    search_input.blur(function () {
        var hr_obj = $(".search_bar").children('hr');
        hr_obj.animate({
            width: "0",
            opacity: "0"
        },200);
        if(search_input.val()===""){
            custom_add_btn.animate({
                opacity: "1",
                top: "-=5rem"
            },200);
            search_container.animate({
                opacity: "0"
            },200);
            setTimeout(function () {
                search_container.css("display","none");
            },200);
            search_container_none.animate({
                opacity: "0"
            },200);
            setTimeout(function () {
                search_container_none.css("display","none");
            },200);
        }
    });
    search_input.on('input propertychange',function(){
        var search_input = $("#event_search_input");
        if(search_input.html().length>10){
            search_input.html(search_event_input_available)
        }else if(search_input.html()==='<br>'){
            search_input.html("课程代码 事件名称");
        } else{
            search_event_input_available = search_input.html();
        }
    });
    $('#panel_picker_year').on('mousewheel', function (event) {
        var year = parseInt($('#panel_picker_year').html());
        var month = parseInt($('#panel_picker_month').html());
        if(event.deltaY===1){
            calendar_init(undefined, year-1, month);
        }
        if(event.deltaY===-1){
            calendar_init(undefined, year+1, month);
        }
    });
    $('#panel_picker_month').on('mousewheel', function (event) {
        var year = parseInt($('#panel_picker_year').html());
        var month = parseInt($('#panel_picker_month').html());
        if(event.deltaY===1){
            calendar_init(undefined, year, month-1);
        }
        if(event.deltaY===-1){
            calendar_init(undefined, year, month+1);
        }
    });
    $('#panel_picker_day').on('mousewheel', function (event) {
        var year = parseInt($('#panel_picker_year').html());
        var month = parseInt($('#panel_picker_month').html());
        if(event.deltaY===1){
            calendar_init(undefined, year, month-1);
        }
        if(event.deltaY===-1){
            calendar_init(undefined, year, month+1);
        }
    });
    $('.panel_pages').on('mousewheel', function (event) {
        var html_p = $('#pre_page').html();
        var html_c = $('#current_page').html();
        var html_n = $('#next_page').html();
        if(event.deltaY===1){
            $('#pre_page').html(html_n);
            $('#current_page').html(html_p);
            $('#next_page').html(html_c);
        }
        if(event.deltaY===-1){
            $('#pre_page').html(html_c);
            $('#current_page').html(html_n);
            $('#next_page').html(html_p);
        }
    });
    var pick_day = $('.picker_day');
    pick_day.on('contextmenu', function(event){
        // if(event.ctrlKey){
        //     alert("!");
        //     return;
        // }
        var pick_obj = event.target;
        var s_year = $(pick_obj).attr("s_year");
        var s_month = $(pick_obj).attr("s_month");
        var s_date = $(pick_obj).attr("s_date");
        var date_str = s_year+"-"+s_month+"-"+s_date;
        if(s_year&&s_month&&s_date){
            calendar_init(Date.parse(date_str));
        }else{
            console.log("date load err");
        }
    });
    $('.picker_day').on('click', function(event){
        var pick_obj = event.target;
        var s_year = $(pick_obj).attr("s_year");
        var s_month = $(pick_obj).attr("s_month");
        var s_date = $(pick_obj).attr("s_date");
        var calendar_type = $(pick_obj).attr("calendar_type");
        if(calendar_type==="row_head"){
            date_multi = [];
            var row = $($(event.target).parent().children());
            for(var i=0;i<row.length-1;i++){
                var day_html = $(row[i+1]);
                s_year = day_html.attr("s_year");
                s_month = day_html.attr("s_month");
                s_date = day_html.attr("s_date");
                date_multi_choice(s_year, s_month, s_date, true);
            }
        }else{
            var warning_obj = $('#warning_calendar_pick_limit');
            if(date_multi_choice(s_year, s_month, s_date)){
                animation_blink_hide(warning_obj, true);
            }else{
                // warning_obj.animate({
                //
                // },200)
            }
        }
    });
    $('.desk_flame').on('mousewheel', function (event) {
        var desk_flame = $('.desk_flame');
        var s_h = desk_flame.attr("start_hour");
        var e_h = desk_flame.attr("end_hour");
        console.log(s_h+"+"+e_h);
        setDeskflame(s_h-event.deltaY,e_h-event.deltaY);
        // if(event.deltaY===1){
        //     setDeskflame(s_h-1,e_h-1);
        // }
        // if(event.deltaY===-1){
        //     setDeskflame(s_h+1,e_h+1);
        // }
    });
    $('#new_event_btn').on('click', function (event) {
        if($('#desk').hasClass('left_container_full')){
            $('#desk').removeClass('left_container_full');
            $('#desk').addClass('left_container_half');
        }
        page_example('page_date',0);
        page_example('page_add',2);
    });
    $('#pre_page_btn').on('click', function (event) {
        page_example('page_date',2);
        page_example('page_add',1);
    });
</script>
</html>